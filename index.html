<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STå›½è©¦ é«˜é€Ÿãƒã‚¹ã‚¿ãƒ¼</title>
    <style>
        /* === ãƒ‡ã‚¶ã‚¤ãƒ³è¨­å®š (CSS) === */
        :root {
            --primary: #0056b3;
            --accent: #e7f1ff;
            --correct: #28a745;
            --wrong: #dc3545;
            --text: #333;
            --bg: #f4f4f9;
        }

        body {
            font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 600px;
            background: white;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        h1, h2 {
            text-align: center;
            color: var(--primary);
        }

        /* ãƒ›ãƒ¼ãƒ ç”»é¢ */
        .menu-grid {
            display: grid;
            gap: 15px;
            margin-top: 20px;
        }

        .menu-btn {
            background: white;
            border: 2px solid var(--primary);
            color: var(--primary);
            padding: 20px;
            font-size: 1.2rem;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            transition: 0.3s;
        }

        .menu-btn:hover {
            background: var(--primary);
            color: white;
        }

        /* ã‚¯ã‚¤ã‚ºç”»é¢ */
        #quiz-section, #result-section {
            display: none;
            flex-grow: 1;
            flex-direction: column;
        }

        .status-bar {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ddd;
            border-radius: 4px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.3s;
        }

        .question-box {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .question-img {
            max-width: 100%;
            height: auto;
            max-height: 300px;
            object-fit: contain;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            display: none;
        }

        .options-grid {
            display: grid;
            gap: 10px;
            grid-template-columns: 1fr 1fr; /* 2åˆ—è¡¨ç¤º */
        }

        .option-btn {
            padding: 15px;
            border: 2px solid #eee;
            background: white;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.2s;
            text-align: center;
            font-weight: bold;
        }

        .option-btn:hover {
            background: var(--accent);
            border-color: var(--primary);
        }

        .option-btn.correct {
            background-color: #d4edda;
            border-color: var(--correct);
            color: #155724;
        }

        .option-btn.wrong {
            background-color: #f8d7da;
            border-color: var(--wrong);
            color: #721c24;
        }

        /* çµæœç”»é¢ */
        .result-score {
            font-size: 1.5rem;
            text-align: center;
            margin: 20px 0;
            font-weight: bold;
        }

        .review-badge {
            display: inline-block;
            background: var(--wrong);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-bottom: 10px;
        }

        .action-btn {
            margin-top: 20px;
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px;
            font-size: 1.2rem;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            font-weight: bold;
        }
        
        .action-btn.retry {
            background: #e67e22; /* å¾©ç¿’è‰²ã¯ã‚ªãƒ¬ãƒ³ã‚¸ */
        }

        footer {
            text-align: center;
            font-size: 0.8rem;
            color: #888;
            margin-top: auto;
            padding-top: 20px;
        }
    </style>
</head>
<body>

<div class="container">
    <div id="home-section">
        <h1>STå›½è©¦<br>é«˜é€Ÿãƒã‚¹ã‚¿ãƒ¼</h1>
        <p style="text-align: center;">ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’é¸æŠã—ã¦ãã ã•ã„</p>
        <div class="menu-grid" id="menu-list">
            </div>
    </div>

    <div id="quiz-section">
        <div class="status-bar">
            <span id="mode-indicator">å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰</span>
            <span id="question-count">1 / 10</span>
        </div>
        <div class="progress-bar"><div class="progress-fill" id="progress"></div></div>
        
        <div class="question-box">
            <img id="q-image" src="" alt="å•é¡Œç”»åƒ" class="question-img">
            <div id="q-text">å•é¡Œæ–‡</div>
        </div>
        
        <div class="options-grid" id="options-list">
            </div>
    </div>

    <div id="result-section">
        <h2>ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†</h2>
        <div id="result-content" style="text-align: center;">
            </div>
        <div id="action-area">
            </div>
    </div>

    <footer>
        &copy; 2024 ST Study App
    </footer>
</div>

<script>
    // === å•é¡Œãƒ‡ãƒ¼ã‚¿ ===
    // è¨€èªè´è¦šè¨ºæ–­å­¦ã¯ã€Œè¦–è¦šã®ä¼å°è·¯.jpgã€ã‚’ä½¿ç”¨
    const quizData = {
        "diagnostics": {
            title: "è¨€èªè´è¦šè¨ºæ–­å­¦",
            questions: [
                { q: "å›³ã®ã€1ã€‘ã®åç§°ã¯ã©ã‚Œã‹ã€‚", options: ["è¦–ç¥çµŒ", "å‹•çœ¼ç¥çµŒ", "å—…ç¥çµŒ", "ä¸‰å‰ç¥çµŒ"], a: "è¦–ç¥çµŒ", img: "è¦–è¦šã®ä¼å°è·¯.jpg" },
                { q: "å›³ã®ã€2ã€‘ï¼ˆäº¤å·®éƒ¨ï¼‰ã®åç§°ã¯ã©ã‚Œã‹ã€‚", options: ["è¦–äº¤å‰", "è„³æ¢", "éŒä½“äº¤å‰", "å‰äº¤é€£"], a: "è¦–äº¤å‰", img: "è¦–è¦šã®ä¼å°è·¯.jpg" },
                { q: "å›³ã®ã€3ã€‘ã®åç§°ã¯ã©ã‚Œã‹ã€‚", options: ["è¦–ç´¢", "è¦–ç¥çµŒ", "å¤–å´æ¯›å¸¯", "å†…å´æ¯›å¸¯"], a: "è¦–ç´¢", img: "è¦–è¦šã®ä¼å°è·¯.jpg" },
                { q: "å›³ã®ã€4ã€‘ï¼ˆä¸­ç¶™æ ¸ï¼‰ã®åç§°ã¯ã©ã‚Œã‹ã€‚", options: ["å¤–å´è†çŠ¶ä½“", "å†…å´è†çŠ¶ä½“", "èµ¤æ ¸", "é»’è³ª"], a: "å¤–å´è†çŠ¶ä½“", img: "è¦–è¦šã®ä¼å°è·¯.jpg" },
                { q: "å›³ã®ã€5ã€‘ã®åç§°ã¯ã©ã‚Œã‹ã€‚", options: ["è¦–æ”¾ç·š", "å†…åŒ…", "æ”¾ç·šå† ", "è¦–åºŠ"], a: "è¦–æ”¾ç·š", img: "è¦–è¦šã®ä¼å°è·¯.jpg" },
                { q: "å›³ã®ã€6ã€‘ï¼ˆåˆ°é”éƒ¨ä½ï¼‰ã®åç§°ã¯ã©ã‚Œã‹ã€‚", options: ["è¦–è¦šé‡", "è´è¦šé‡", "ä½“æ€§æ„Ÿè¦šé‡", "é‹å‹•é‡"], a: "è¦–è¦šé‡", img: "è¦–è¦šã®ä¼å°è·¯.jpg" }
            ]
        },
        "psychoacoustics": {
            title: "éŸ³éŸ¿å¿ƒç†å­¦",
            questions: [
                { q: "ãƒ’ãƒˆã®å¯è´åŸŸã®å‘¨æ³¢æ•°ç¯„å›²ã¯ï¼Ÿ", options: ["20ã€œ20,000Hz", "100ã€œ10,000Hz", "1,000ã€œ4,000Hz", "500ã€œ2,000Hz"], a: "20ã€œ20,000Hz", img: null },
                { q: "éŸ³ã®é«˜ã•ã«æœ€ã‚‚å½±éŸ¿ã™ã‚‹ç‰©ç†é‡ã¯ï¼Ÿ", options: ["å‘¨æ³¢æ•°", "æŒ¯å¹…", "ä½ç›¸", "å€éŸ³"], a: "å‘¨æ³¢æ•°", img: null },
                { q: "ç­‰ãƒ©ã‚¦ãƒ‰ãƒã‚¹æ›²ç·šã®å˜ä½ã¯ï¼Ÿ", options: ["phon", "sone", "mel", "dB"], a: "phon", img: null },
                { q: "ã‚«ã‚¯ãƒ†ãƒ«ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼åŠ¹æœã¨é–¢é€£ãŒæ·±ã„ã®ã¯ï¼Ÿ", options: ["ä¸¡è€³è´åŠ¹æœ", "ãƒã‚¹ã‚­ãƒ³ã‚°", "ãƒ‰ãƒƒãƒ—ãƒ©ãƒ¼åŠ¹æœ", "ãƒãƒ¼ã‚¹åŠ¹æœ"], a: "ä¸¡è€³è´åŠ¹æœ", img: null },
                { q: "éŸ³åœ§ãŒ10å€ã«ãªã‚‹ã¨éŸ³åœ§ãƒ¬ãƒ™ãƒ«ã¯ä½•dBä¸ŠãŒã‚‹ï¼Ÿ", options: ["20dB", "10dB", "3dB", "6dB"], a: "20dB", img: null },
                { q: "1000Hz 40dB SPLã®ãƒ©ã‚¦ãƒ‰ãƒã‚¹ãƒ¬ãƒ™ãƒ«ã¯ï¼Ÿ", options: ["40phon", "1sone", "1000mel", "40dB HL"], a: "40phon", img: null },
                { q: "ä½éŸ³ãŒèª¤ã£ã¦é«˜éŸ³ã‚’å¦¨å®³ã™ã‚‹ç¾è±¡ã¯ï¼Ÿ", options: ["ä¸Šè¡Œæ€§ãƒã‚¹ã‚­ãƒ³ã‚°", "ä¸‹è¡Œæ€§ãƒã‚¹ã‚­ãƒ³ã‚°", "ä¸­å¿ƒå‘¨æ³¢æ•°", "è‡¨ç•Œå¸¯åŸŸ"], a: "ä¸Šè¡Œæ€§ãƒã‚¹ã‚­ãƒ³ã‚°", img: null },
                { q: "éŸ³ã®3è¦ç´ ã«å«ã¾ã‚Œãªã„ã®ã¯ï¼Ÿ", options: ["é€Ÿåº¦", "å¤§ãã•", "é«˜ã•", "éŸ³è‰²"], a: "é€Ÿåº¦", img: null },
                { q: "å¼åˆ¥é–¾ãŒåˆºæ¿€é‡ã«æ¯”ä¾‹ã™ã‚‹ã¨ã„ã†æ³•å‰‡ã¯ï¼Ÿ", options: ["ã‚¦ã‚§ãƒ¼ãƒãƒ¼ã®æ³•å‰‡", "ãƒ•ã‚§ãƒ’ãƒŠãƒ¼ã®æ³•å‰‡", "ã‚¹ãƒ†ã‚£ãƒ¼ãƒ–ãƒ³ã‚¹ã®æ³•å‰‡", "ã‚ªãƒ¼ãƒ ã®æ³•å‰‡"], a: "ã‚¦ã‚§ãƒ¼ãƒãƒ¼ã®æ³•å‰‡", img: null },
                { q: "ä¸¡è€³é–“æ™‚é–“å·®(ITD)ãŒæœ‰åŠ¹ãªå‘¨æ³¢æ•°å¸¯ã¯ï¼Ÿ", options: ["ä½å‘¨æ³¢æ•°åŸŸ", "ä¸­å‘¨æ³¢æ•°åŸŸ", "é«˜å‘¨æ³¢æ•°åŸŸ", "å…¨å‘¨æ³¢æ•°åŸŸ"], a: "ä½å‘¨æ³¢æ•°åŸŸ", img: null }
            ]
        },
        "anatomy": {
            title: "è§£å‰–å­¦",
            questions: [
                { q: "ãƒ–ãƒ­ãƒ¼ã‚«é‡ãŒå­˜åœ¨ã™ã‚‹ã®ã¯ï¼Ÿ", options: ["å‰é ­è‘‰", "å´é ­è‘‰", "é ­é ‚è‘‰", "å¾Œé ­è‘‰"], a: "å‰é ­è‘‰", img: null },
                { q: "è´è¦šé‡ãŒå­˜åœ¨ã™ã‚‹ã®ã¯ï¼Ÿ", options: ["å´é ­è‘‰", "å‰é ­è‘‰", "é ­é ‚è‘‰", "å¾Œé ­è‘‰"], a: "å´é ­è‘‰", img: null },
                { q: "é¼“è†œã«æ¥ã—ã¦ã„ã‚‹è€³å°éª¨ã¯ï¼Ÿ", options: ["ãƒ„ãƒéª¨", "ã‚­ãƒŒã‚¿éª¨", "ã‚¢ãƒ–ãƒŸéª¨", "è¸ç‰›"], a: "ãƒ„ãƒéª¨", img: null },
                { q: "é¡”é¢ç¥çµŒãŒæ”¯é…ã™ã‚‹ç­‹ã¯ï¼Ÿ", options: ["å£è¼ªç­‹", "å’¬ç­‹", "å´é ­ç­‹", "å¤–å´ç¿¼çªç­‹"], a: "å£è¼ªç­‹", img: null },
                { q: "èª¤åš¥é˜²æ­¢ã§å–‰é ­ã‚’æŒ™ä¸Šã•ã›ã‚‹ç­‹ã¯ï¼Ÿ", options: ["èˆŒéª¨ä¸Šç­‹ç¾¤", "èˆŒéª¨ä¸‹ç­‹ç¾¤", "å’½é ­åç¸®ç­‹", "èƒ¸é–ä¹³çªç­‹"], a: "èˆŒéª¨ä¸Šç­‹ç¾¤", img: null },
                { q: "è„³å¹¹ã«å«ã¾ã‚Œãªã„ã®ã¯ï¼Ÿ", options: ["å°è„³", "ä¸­è„³", "æ©‹", "å»¶é«„"], a: "å°è„³", img: null },
                { q: "ç¬¬Xè„³ç¥çµŒã¯ï¼Ÿ", options: ["è¿·èµ°ç¥çµŒ", "èˆŒå’½ç¥çµŒ", "å‰¯ç¥çµŒ", "èˆŒä¸‹ç¥çµŒ"], a: "è¿·èµ°ç¥çµŒ", img: null },
                { q: "å£°å¸¯ã‚’é–‹ãå”¯ä¸€ã®ç­‹ã¯ï¼Ÿ", options: ["å¾Œè¼ªçŠ¶æŠ«è£‚ç­‹", "å¤–å´è¼ªçŠ¶æŠ«è£‚ç­‹", "ç”²çŠ¶æŠ«è£‚ç­‹", "è¼ªçŠ¶ç”²çŠ¶ç­‹"], a: "å¾Œè¼ªçŠ¶æŠ«è£‚ç­‹", img: null },
                { q: "æµ·é¦¬ã®ä¸»ãªæ©Ÿèƒ½ã¯ï¼Ÿ", options: ["è¨˜æ†¶ã®å½¢æˆ", "é‹å‹•ã®èª¿æ•´", "è¦–è¦šå‡¦ç†", "å‘¼å¸èª¿ç¯€"], a: "è¨˜æ†¶ã®å½¢æˆ", img: null },
                { q: "éŒä½“è·¯ãŒé€šã‚‹éƒ¨ä½ã¯ï¼Ÿ", options: ["å†…åŒ…å¾Œè„š", "å†…åŒ…å‰è„š", "å¤–åŒ…", "æœ€å¤–åŒ…"], a: "å†…åŒ…å¾Œè„š", img: null }
            ]
        }
    };

    // === ã‚¢ãƒ—ãƒªçŠ¶æ…‹å¤‰æ•° ===
    let currentQueue = [];      // ç¾åœ¨å‡ºé¡Œã™ã‚‹å•é¡Œãƒªã‚¹ãƒˆ
    let wrongQueue = [];        // é–“é•ãˆãŸå•é¡Œãƒªã‚¹ãƒˆï¼ˆå¾©ç¿’ç”¨ï¼‰
    let currentSectionTitle = "";
    let currentIndex = 0;
    let isReviewMode = false;   // å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰ã‹ã©ã†ã‹ã®ãƒ•ãƒ©ã‚°
    let isAnswering = false;

    // åˆæœŸåŒ–
    function init() {
        const menuList = document.getElementById('menu-list');
        menuList.innerHTML = "";
        for (const key in quizData) {
            const btn = document.createElement('button');
            btn.className = 'menu-btn';
            btn.innerText = quizData[key].title;
            btn.onclick = () => startQuiz(key);
            menuList.appendChild(btn);
        }
    }

    // ã‚¯ã‚¤ã‚ºé–‹å§‹ï¼ˆåˆå›ï¼‰
    function startQuiz(sectionKey) {
        currentSectionTitle = quizData[sectionKey].title;
        // å•é¡Œã‚’ãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ”ãƒ¼ã—ã¦ã‚·ãƒ£ãƒƒãƒ•ãƒ«
        currentQueue = JSON.parse(JSON.stringify(quizData[sectionKey].questions));
        currentQueue.sort(() => Math.random() - 0.5);
        
        wrongQueue = []; // é–“é•ãˆãŸãƒªã‚¹ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆ
        isReviewMode = false;
        
        startSessionLoop();
    }

    // ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹ï¼ˆåˆå›ã¾ãŸã¯å¾©ç¿’ã®ãƒ«ãƒ¼ãƒ—é–‹å§‹ï¼‰
    function startSessionLoop() {
        currentIndex = 0;
        
        // ç”»é¢åˆ‡ã‚Šæ›¿ãˆ
        document.getElementById('home-section').style.display = 'none';
        document.getElementById('result-section').style.display = 'none';
        document.getElementById('quiz-section').style.display = 'flex';
        
        // ãƒ¢ãƒ¼ãƒ‰è¡¨ç¤ºæ›´æ–°
        const modeText = isReviewMode ? "ğŸ”¥ å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰" : "ğŸ“ å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰";
        document.getElementById('mode-indicator').innerText = modeText;
        document.getElementById('mode-indicator').style.color = isReviewMode ? "#dc3545" : "#666";

        loadQuestion();
    }

    // å•é¡Œèª­ã¿è¾¼ã¿
    function loadQuestion() {
        isAnswering = true;
        const qData = currentQueue[currentIndex];

        // ã‚«ã‚¦ãƒ³ãƒˆè¡¨ç¤º
        document.getElementById('question-count').innerText = `${currentIndex + 1} / ${currentQueue.length}`;
        
        // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼
        const progressPercent = (currentIndex / currentQueue.length) * 100;
        document.getElementById('progress').style.width = `${progressPercent}%`;

        // ãƒ†ã‚­ã‚¹ãƒˆè¨­å®š
        document.getElementById('q-text').innerText = qData.q;

        // ç”»åƒè¨­å®š
        const imgElem = document.getElementById('q-image');
        if (qData.img) {
            imgElem.src = qData.img;
            imgElem.style.display = 'block';
            // ç”»åƒèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼æ™‚ã®å‡¦ç†ï¼ˆãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼è¡¨ç¤ºï¼‰
            imgElem.onerror = function() {
                this.style.display = 'none'; 
            };
        } else {
            imgElem.style.display = 'none';
        }

        // é¸æŠè‚¢ç”Ÿæˆ
        const optionsDiv = document.getElementById('options-list');
        optionsDiv.innerHTML = '';
        
        // é¸æŠè‚¢ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«
        const shuffledOptions = [...qData.options].sort(() => Math.random() - 0.5);

        shuffledOptions.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = opt;
            btn.onclick = () => checkAnswer(btn, opt, qData.a);
            optionsDiv.appendChild(btn);
        });
    }

    // åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯
    function checkAnswer(btn, selected, correct) {
        if (!isAnswering) return;
        isAnswering = false;

        const allBtns = document.querySelectorAll('.option-btn');
        const qData = currentQueue[currentIndex];

        if (selected === correct) {
            btn.classList.add('correct');
            // æ­£è§£æ™‚ã¯éŸ³ã‚’é³´ã‚‰ã—ã¦ã‚‚è‰¯ã„ï¼ˆä»Šå›ã¯çœç•¥ï¼‰
        } else {
            btn.classList.add('wrong');
            // é–“é•ãˆãŸå•é¡Œã‚’ãƒªã‚¹ãƒˆã«è¿½åŠ ï¼ˆé‡è¤‡ã—ãªã„ã‚ˆã†ã«ç®¡ç†ï¼‰
            // â€» ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§åŒã˜å•é¡Œã‚’è¤‡æ•°å›è¿½åŠ ã—ãªã„ã‚ˆã†ã«ã™ã‚‹
            // ä»Šå›ã¯å˜ç´”ã«ã‚­ãƒ¥ãƒ¼ã«è¿½åŠ 
            wrongQueue.push(qData);

            // æ­£è§£ã‚’è¡¨ç¤º
            allBtns.forEach(b => {
                if (b.innerText === correct) {
                    b.classList.add('correct');
                }
            });
        }

        // æ¬¡ã¸
        setTimeout(() => {
            currentIndex++;
            if (currentIndex < currentQueue.length) {
                loadQuestion();
            } else {
                showRoundResult();
            }
        }, 800); // ã‚µã‚¯ã‚µã‚¯é€²ã‚ã‚‹ã‚ˆã†æ™‚é–“ã‚’çŸ­ç¸®
    }

    // ãƒ©ã‚¦ãƒ³ãƒ‰çµ‚äº†æ™‚ã®åˆ¤å®šï¼ˆé‡è¦ï¼šé«˜é€Ÿãƒã‚¹ã‚¿ãƒ¼ä»•æ§˜ï¼‰
    function showRoundResult() {
        document.getElementById('quiz-section').style.display = 'none';
        document.getElementById('result-section').style.display = 'flex';

        const resultContent = document.getElementById('result-content');
        const actionArea = document.getElementById('action-area');
        
        resultContent.innerHTML = '';
        actionArea.innerHTML = '';

        if (wrongQueue.length === 0) {
            // å…¨å•æ­£è§£ï¼ˆå®Œå…¨ã‚¯ãƒªã‚¢ï¼‰
            resultContent.innerHTML = `
                <h3 style="color:var(--correct); font-size:2rem;">å®Œå…¨ç¿’å¾—ï¼ğŸ‰</h3>
                <p>ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®å•é¡Œã¯ã™ã¹ã¦ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸã€‚</p>
            `;
            const homeBtn = document.createElement('button');
            homeBtn.className = 'action-btn';
            homeBtn.innerText = 'ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹';
            homeBtn.onclick = goHome;
            actionArea.appendChild(homeBtn);

        } else {
            // é–“é•ã„ãŒã‚ã‚‹å ´åˆï¼ˆå¾©ç¿’èª˜å°ï¼‰
            resultContent.innerHTML = `
                <p class="result-score">æ®‹ã‚Š ${wrongQueue.length} å•</p>
                <p>é–“é•ãˆãŸå•é¡ŒãŒæ®‹ã£ã¦ã„ã¾ã™ã€‚<br>å…¨å•æ­£è§£ã™ã‚‹ã¾ã§çµ‚ã‚ã‚Šã¾ã›ã‚“ï¼</p>
            `;
            
            const retryBtn = document.createElement('button');
            retryBtn.className = 'action-btn retry';
            retryBtn.innerText = 'é–“é•ãˆãŸå•é¡Œã‚’å¾©ç¿’ã™ã‚‹';
            retryBtn.onclick = startReviewRound;
            actionArea.appendChild(retryBtn);
        }
    }

    // å¾©ç¿’ãƒ©ã‚¦ãƒ³ãƒ‰ã®é–‹å§‹
    function startReviewRound() {
        isReviewMode = true;
        // é–“é•ãˆãŸå•é¡Œãƒªã‚¹ãƒˆã‚’æ¬¡ã®å‡ºé¡Œãƒªã‚¹ãƒˆã«è¨­å®š
        currentQueue = [...wrongQueue];
        // é †ç•ªã‚’å…¥ã‚Œæ›¿ãˆã‚‹ï¼ˆé£½ãã•ã›ãªã„ãŸã‚ï¼‰
        currentQueue.sort(() => Math.random() - 0.5);
        // é–“é•ãˆãŸãƒªã‚¹ãƒˆã‚’ç©ºã«ã™ã‚‹ï¼ˆä»Šå›ã®ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã¾ãŸé–“é•ãˆãŸã‚‰ã“ã“ã«è¿½åŠ ã•ã‚Œã‚‹ï¼‰
        wrongQueue = [];
        
        startSessionLoop();
    }

    function goHome() {
        document.getElementById('result-section').style.display = 'none';
        document.getElementById('home-section').style.display = 'block';
    }

    init();

</script>

</body>
</html>